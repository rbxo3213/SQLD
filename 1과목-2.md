# 정규화

- 데이터 정합성을 위해 엔터티를 작은 단위로 분리하는 과정
- 입력, 삭제, 수정 성능 보통 향상됨(삽삭갱 이상현상 해결)
- 조회(SELECT) 성능은 향상되거나 저하됨(JOIN 잦을 시 저하됨)
  - 삽입이상: 주문되지 않은 상품의 정보를 삽입할 수 없다. 삽입하려면 가짜 주문번호를 같이 삽입해야 함. 또는 NULL
  - 삭제이상: 주문 데이터를 삭제할 때 상품 데이터도 같이 삭제될 수 있다.
  - 갱신이상: 중복된 데이터 중 일부 데이터만 업데이트 되어 데이터 불일치가 발생할 수 있다.

# 반정규화

- 조회 성능의 향상 위해 중복을 허용 또는 데이터를 그룹화 하는 것.
- 정규화가 끝난 후 수행함.!!
- 조회 성능은 향상되나 입력, 수정, 삭제 성능이 저하될 수 있음.
- 데이터 정합성 이슈 발생 가능성

## 반정규화 방법

1. 테이블 병합: JOIN 잦아 통합이 유리할 경우 사용
   - 1:M 병합: 1쪽의 속성이 많으면 중복이 증가하므로 부적절함
   - 1:1 병합: 비교적 수월, 부작용 적음
   - 슈퍼/서브타입 테이블 병합
     - 슈퍼/서브타입: 공통 속성과 개별 속성을 별도로 관리하는 것
2. 테이블 분할:

   - 테이블 수직 분할: 엔터티의 일부 속성을 별도의 엔터티로 분할(1:1관계로 분할됨, 1:M 아님)함, 한 테이블의 속성이 과도하게 많거나, 자주 사용하는 속성이 아니거나 대부분의 인스턴스가 해당 속성값을 NULL로 가질 때 고려함. (회원 - 회원 배우자 1:1)
     - 테이블을 수직 분할하면 한 개의 블록에 더 많은 인스턴스를 저장할 수 있게 된다.
   - 테이블 수평 분할: 엔터티의 인스턴스를 특정 기준으로 별도의 엔터티로 분할(파티셔닝)함 (물리적 분리).
     - 데이터 양이 매우 많을 때, 접근 패턴이 분리될 때(과거 / 현재), 병렬 처리 및 분산 저장이 필요할 때 고려함.
     - 테이블을 수평 분할하면 관계가 없는 다수의 테이블이 생성됨. (각 파티션은 독립, 서로 관계 x) (주문-> 2022주문, 2023주문)

3. 테이블 추가: [중통이부]
   - 중복 테이블 추가
   - 통계 테이블 추가 - 지점 별 월매출
   - 이력 테이블 추가 - 상품가격 이력(과거 데이터)
   - 부분 테이블 추가 - 메일 발송이 다량으로 발생, 메일 발송에 필요한 부분만 부분테이블로 생성

- but 단순히 같은 데이터를 여러 테이블에 저장하는 것은 데이터 정합성에 위배되는 상황을 발생시킬 수 있다.

### 4. 컬럼 반정규화 - [중복 파생 이력]

1. 중복 컬럼 추가: JOIN이 잦아 컬럼 추가가 성능에 유리할 경우 고려 - 최근 상품 가격?? 등
2. 파생 컬럼 추가(계산값): 프로세스에 부하가 염려되는 '계산값을 미리 컬럼으로 추가' - 상품의 재고, 프로모션 적용 할인가 등
3. 이력 테이블 컬럼 추가(조회기준): 대량의 이력 테이블을 조회할 때 속도가 느려질 것을 대비, '조회 기준'으로 판단되는 컬럼을 미리 추가 - 최신 데이터 여부 등

### 5. 관계 반정규화

1. 중복 관계 추가: JOIN이 잦아 중복 관계 추가가 성능에 유리할 경우 고려
   - 데이터 무결성을 깨뜨릴 위험 없이 데이터 처리 성능을 향상시킬 수 있는 기법
     - 중복 테이블 추가
     - 중복 관계 추가
     - 수평 분할
     - 인덱스 추가

# 트랜잭션(Transaction)

- 데이터 조작을 위한 하나의 논리적 작업 단위
  - 물리적 X
  - 데이터는 트랜잭션 범위로 묶일 수 있다.
  - 데이터 모델로 표현이 가능하다.
  - 하나의 커밋 단위로 묶여야 한다.

# NULL

- 존재하지 않음, 값이 없음을 의미
- 0과 NULL은 다르다. NULL은 0일수도, 수천만일 수도 있다. 어떠한 사유로 입력되지 않아 NULL 값이 된 것이다.
  - 가로 연산에 NULL이 포함되면 결과값은 NULL이 된다.
  - 세로 연산에 NULL이 포함되면 NULL값을 제외하고 연산단다.
- NULL과 'NULL'은 다르다('NULL'은 NULL이라는 텍스트를 나타낸 것)
- WHERE COL IS NULL 조건은 WHERE COL = NULL 조건과 다르다.
  - = NULL 비교는 항상 거짓(False) 으로 처리
- NULL이 포함된 사칙연산의 결과는 항상 NULL이다.
  - SELECT 100 + NULL; --> 결과: NULL
- SELECT SUM(COL1+COL2) -> 수평연산(COL1+COL2) 결과를 수직연산(SUM), 수평연산에 NULL이 있을 시 NULL이 되어 수직연산에서 제외됨.

# 오답

- 무결성을 해치지 않는 반정규화 기법: 중복테이블 추가, 중복관계 추가, 수평(파티션) 분할, 인덱스 추가?? 왜??
- 분산 데이터베이스는 가용성은 증가하나 여러 개의 데이터베이스가 존재하므로 중앙집중적인 보안관리가 어렵고 처리 비용이 증가함
